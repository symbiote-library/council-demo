/****** FILE: framework/admin/javascript/LeftAndMain.js *****/

jQuery.noConflict();(function($){$.entwine.warningLevel=$.entwine.WARN_LEVEL_BESTPRACTISE;$.entwine('ss',function($){var positionLoadingSpinner=function(){var offset=120;var spinner=$('.ss-loading-screen .loading-animation');var top=($(window).height()-spinner.height())/2;spinner.css('top',top+offset);spinner.show();};var applyChosen=function(el){if(el.is(':visible')){el.addClass('has-chzn').chosen({allow_single_deselect:true,disable_search_threshold:20});var title=el.prop('title')
if(title){el.siblings('.chzn-container').prop('title',title);}}else{setTimeout(function(){applyChosen(el);},500);}};var isSameUrl=function(url1,url2){var baseUrl=$('base').attr('href');url1=$.path.isAbsoluteUrl(url1)?url1:$.path.makeUrlAbsolute(url1,baseUrl),url2=$.path.isAbsoluteUrl(url2)?url2:$.path.makeUrlAbsolute(url2,baseUrl);var url1parts=$.path.parseUrl(url1),url2parts=$.path.parseUrl(url2);return(url1parts.pathname.replace(/\/*$/,'')==url2parts.pathname.replace(/\/*$/,'')&&url1parts.search==url2parts.search);};$(window).bind('resize',positionLoadingSpinner).trigger('resize');$(document).ajaxComplete(function(e,xhr,settings){if(window.History.enabled){var url=xhr.getResponseHeader('X-ControllerURL'),origUrl=History.getPageUrl().replace(/\/$/,''),opts,requestHeaders=settings.headers;if(url!==null&&!isSameUrl(origUrl,url)){opts={pjax:xhr.getResponseHeader('X-Pjax')?xhr.getResponseHeader('X-Pjax'):settings.headers['X-Pjax']};window.History.pushState(opts,'',url);}}
var msg=(xhr.getResponseHeader('X-Status'))?xhr.getResponseHeader('X-Status'):xhr.statusText,msgType=(xhr.status<200||xhr.status>399)?'bad':'good',ignoredMessages=['OK'];if(xhr.status!==0&&msg&&$.inArray(msg,ignoredMessages)){statusMessage(decodeURIComponent(msg),msgType);}});$('.cms-container').entwine({CurrentXHR:null,StateChangeCount:0,onadd:function(){var self=this;if($.browser.msie&&parseInt($.browser.version,10)<7){$('.ss-loading-screen').append('<p class="ss-loading-incompat-warning"><span class="notice">'+'Your browser is not compatible with the CMS interface. Please use Internet Explorer 7+, Google Chrome 10+ or Mozilla Firefox 3.5+.'+'</span></p>').css('z-index',$('.ss-loading-screen').css('z-index')+1);$('.loading-animation').remove();this._super();return;}
this.redraw();$('.ss-loading-screen').hide();$('body').removeClass('loading');$(window).unbind('resize',positionLoadingSpinner);this._super();},fromWindow:{onstatechange:function(){this.handleStateChange();},onresize:function(){this.redraw();}},'from .cms-panel':{ontoggle:function(){this.redraw();}},'from .cms-container':{onaftersubmitform:function(){this.redraw();}},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.layout({resize:false});this.find('.cms-panel-layout').redraw();this.find('.cms-content-fields[data-layout-type]').redraw();this.find('.cms-edit-form[data-layout-type]').redraw();this.find('.cms-preview').redraw();this.find('.cms-content').redraw();this.layout({resize:false});},loadPanel:function(url,title,data,forceReload){if(!data)data={};if(!title)title="";var contentEls=this._findFragments(data.pjax?data.pjax.split(','):['Content']);var trackedEls=contentEls.find(':data(changetracker)').add(contentEls.filter(':data(changetracker)'));if(trackedEls.length){var abort=false;trackedEls.each(function(){if(!$(this).confirmUnsavedChanges())abort=true;});if(abort)return;}
this.saveTabState();if(window.History.enabled){if(forceReload){$.extend(data,{__forceReload:Math.random()});window.History.replaceState(data,title,url);}else{window.History.pushState(data,title,url);}}else{window.location=$.path.makeUrlAbsolute(url,$('base').attr('href'));}},reloadCurrentPanel:function(){this.loadPanel(window.History.getState().url,null,null,true);},submitForm:function(form,button,callback,ajaxOptions){var self=this;if(!button)button=this.find('.Actions :submit[name=action_save]');if(!button)button=this.find('.Actions :submit:first');form.trigger('beforesubmitform');this.trigger('submitform',{form:form,button:button});$(button).addClass('loading');if(!form.validate()){statusMessage("Validation failed.","bad");$(button).removeClass('loading');return false;}
var formData=form.serializeArray();formData.push({name:$(button).attr('name'),value:'1'});formData.push({name:'BackURL',value:History.getPageUrl()});this.saveTabState();jQuery.ajax(jQuery.extend({headers:{"X-Pjax":"CurrentForm,Breadcrumbs"},url:form.attr('action'),data:formData,type:'POST',complete:function(){$(button).removeClass('loading');},success:function(data,status,xhr){form.removeClass('changed');if(callback)callback(data,status,xhr);var newContentEls=self.handleAjaxResponse(data,status,xhr);if(!newContentEls)return;newContentEls.filter('form').trigger('aftersubmitform',{status:status,xhr:xhr,formData:formData});}},ajaxOptions));return false;},handleStateChange:function(){if(this.getCurrentXHR())this.getCurrentXHR().abort();var self=this,h=window.History,state=h.getState(),fragments=state.data.pjax||'Content',headers={},fragmentsArr=fragments.split(','),contentEls=this._findFragments(fragmentsArr);this.setStateChangeCount(this.getStateChangeCount()+1);var isLegacyIE=($.browser.msie&&parseInt($.browser.version,10)<9);if(isLegacyIE&&this.getStateChangeCount()>20){document.location.href=state.url;return;}
if(contentEls.length<fragmentsArr.length){fragments='Content',fragmentsArr=['Content'];contentEls=this._findFragments(fragmentsArr);}
this.trigger('beforestatechange',{state:state,element:contentEls});headers['X-Pjax']=fragments;contentEls.addClass('loading');var xhr=$.ajax({headers:headers,url:state.url,complete:function(){contentEls.removeClass('loading');},success:function(data,status,xhr){var els=self.handleAjaxResponse(data,status,xhr);self.trigger('afterstatechange',{data:data,status:status,xhr:xhr,element:els});}});this.setCurrentXHR(xhr);},handleAjaxResponse:function(data,status,xhr){var self=this,url,selectedTabs,guessFragment;if(!data)return;var title=xhr.getResponseHeader('X-Title');if(title)document.title=title;var newFragments={},newContentEls;if(xhr.getResponseHeader('Content-Type')=='text/json'){newFragments=data;}else{$data=$(data);guessFragment='Content';if($data.is('form')&&!$data.is('[data-pjax-fragment~=Content]'))guessFragment='CurrentForm';newFragments[guessFragment]=$data;}
$.each(newFragments,function(newFragment,html){var contentEl=$('[data-pjax-fragment]').filter(function(){return $.inArray(newFragment,$(this).data('pjaxFragment').split(' '))!=-1;}),newContentEl=$(html);if(newContentEls)newContentEls.add(newContentEl);else newContentEls=newContentEl;if(newContentEl.find('.cms-container').length){throw'Content loaded via ajax is not allowed to contain tags matching the ".cms-container" selector to avoid infinite loops';}
var origStyle=contentEl.attr('style');var origVisible=contentEl.is(':visible');var layoutClasses=['east','west','center','north','south'];var elemClasses=contentEl.attr('class');var origLayoutClasses=[];if(elemClasses){origLayoutClasses=$.grep(elemClasses.split(' '),function(val){return($.inArray(val,layoutClasses)>=0);});}
newContentEl.removeClass(layoutClasses.join(' ')).addClass(origLayoutClasses.join(' '));if(origStyle)newContentEl.attr('style',origStyle);newContentEl.css('visibility','hidden');var styles=newContentEl.find('style').detach();if(styles.length)$(document).find('head').append(styles);contentEl.replaceWith(newContentEl);if(origVisible)newContentEl.css('visibility','visible');});var newForm=newContentEls.filter('form');if(newForm.hasClass('cms-tabset'))newForm.removeClass('cms-tabset').addClass('cms-tabset');this.redraw();this.restoreTabState();return newContentEls;},_findFragments:function(fragments){return $('[data-pjax-fragment]').filter(function(){var i,nodeFragments=$(this).data('pjaxFragment').split(' ');for(i in fragments){if($.inArray(fragments[i],nodeFragments)!=-1)return true;}
return false;});},refresh:function(){$(window).trigger('statechange');$(this).redraw();},saveTabState:function(){if(typeof(window.sessionStorage)=="undefined"||window.sessionStorage==null)return;var selectedTabs=[],url=this._tabStateUrl();this.find('.cms-tabset,.ss-tabset').each(function(i,el){var id=$(el).attr('id');if(!id)return;if(!$(el).data('tabs'))return;if($(el).data('ignoreTabState'))return;selectedTabs.push({id:id,selected:$(el).tabs('option','selected')});});if(selectedTabs)window.sessionStorage.setItem('tabs-'+url,JSON.stringify(selectedTabs));},restoreTabState:function(){if(typeof(window.sessionStorage)=="undefined"||window.sessionStorage==null)return;var self=this,url=this._tabStateUrl(),data=window.sessionStorage.getItem('tabs-'+url),selectedTabs=data?JSON.parse(data):false;if(selectedTabs){$.each(selectedTabs,function(i,selectedTab){var el=self.find('#'+selectedTab.id);if(!el.data('tabs'))return;el.tabs('select',selectedTab.selected);});}},clearTabState:function(url){if(typeof(window.sessionStorage)=="undefined")return;var s=window.sessionStorage;if(url){s.removeItem('tabs-'+url);}else{for(var i=0;i<s.length;i++)s.removeItem(s.key(i));}},clearCurrentTabState:function(){this.clearTabState(this._tabStateUrl());},_tabStateUrl:function(){return History.getState().url.replace(/\?.*/,'').replace(/#.*/,'').replace($('base').attr('href'),'');}});$('form.loading,.cms-content.loading,.cms-content-fields.loading,.cms-content-view.loading').entwine({onmatch:function(){this.append('<div class="cms-content-loading-overlay ui-widget-overlay-light"></div><div class="cms-content-loading-spinner"></div>');this._super();},onunmatch:function(){this.find('.cms-content-loading-overlay,.cms-content-loading-spinner').remove();this._super();}});$('.cms input[type="submit"], .cms button, .cms input[type="reset"], .cms .ss-ui-button').entwine({onadd:function(){this.addClass('ss-ui-button');if(!this.data('button'))this.button();this._super();},onremove:function(){this.button('destroy');this._super();}});$('.cms .cms-panel-link').entwine({onclick:function(e){var href=this.attr('href'),url=(href&&!href.match(/^#/))?href:this.data('href'),data={pjax:this.data('pjaxTarget')};$('.cms-container').loadPanel(url,null,data);e.preventDefault();}});$('.cms .ss-ui-button-ajax').entwine({onclick:function(e){$(this).removeClass('ui-button-text-only');$(this).addClass('ss-ui-button-loading ui-button-text-icons');var loading=$(this).find(".ss-ui-loading-icon");if(loading.length<1){loading=$("<span></span>").addClass('ss-ui-loading-icon ui-button-icon-primary ui-icon');$(this).prepend(loading);}
loading.show();var href=this.attr('href'),url=href?href:this.data('href');jQuery.ajax({url:url,complete:function(xmlhttp,status){var msg=(xmlhttp.getResponseHeader('X-Status'))?xmlhttp.getResponseHeader('X-Status'):xmlhttp.responseText;try{if(typeof msg!="undefined"&&msg!=null)eval(msg);}
catch(e){}
loading.hide();$(".cms-container").refresh();$(this).removeClass('ss-ui-button-loading ui-button-text-icons');$(this).addClass('ui-button-text-only');},dataType:'html'});e.preventDefault();}});$('.cms .ss-ui-dialog-link').entwine({UUID:null,onmatch:function(){this._super();this.setUUID(new Date().getTime());},onunmatch:function(){this._super();},onclick:function(){this._super();var self=this,id='ss-ui-dialog-'+this.getUUID();var dialog=$('#'+id);if(!dialog.length){dialog=$('<div class="ss-ui-dialog" id="'+id+'" />');$('body').append(dialog);}
var extraClass=this.data('popupclass')?this.data('popupclass'):'';dialog.ssdialog({iframeUrl:this.attr('href'),autoOpen:true,dialogExtraClass:extraClass});return false;}});$('.cms-content .Actions').entwine({onmatch:function(){this.find('.ss-ui-button').click(function(){var form=this.form;if(form){form.clickedButton=this;setTimeout(function(){form.clickedButton=null;},10);}});this.redraw();this._super();},onunmatch:function(){this._super();},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.contents().filter(function(){return(this.nodeType==3&&!/\S/.test(this.nodeValue));}).remove();this.find('.ss-ui-button').each(function(){if(!$(this).data('button'))$(this).button();});this.find('.ss-ui-buttonset').buttonset();}});$('.cms .field.date input.text').entwine({onmatch:function(){var holder=$(this).parents('.field.date:first'),config=holder.data();if(!config.showcalendar){this._super();return;}
config.showOn='button';if(config.locale&&$.datepicker.regional[config.locale]){config=$.extend(config,$.datepicker.regional[config.locale],{});}
$(this).datepicker(config);this._super();},onunmatch:function(){this._super();}});$('.cms .field.dropdown select, .cms .field select[multiple]').entwine({onmatch:function(){if(this.is('.no-chzn')){this._super();return;}
if(!this.data('placeholder'))this.data('placeholder',' ');this.removeClass('has-chzn chzn-done');this.siblings('.chzn-container').remove();applyChosen(this);this._super();},onunmatch:function(){this._super();}});$(".cms-panel-layout").entwine({redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.layout({resize:false});}});$('.cms .ss-gridfield').entwine({showDetailView:function(url){var params=window.location.search.replace(/^\?/,'');if(params)url=$.path.addSearchParams(url,params);$('.cms-container').loadPanel(url);}});$('.cms-search-form').entwine({onsubmit:function(){var nonEmptyInputs=this.find(':input:not(:submit)').filter(function(){var vals=$.grep($(this).fieldValue(),function(val){return(val);});return(vals.length);});var url=this.attr('action');if(nonEmptyInputs.length)url=$.path.addSearchParams(url,nonEmptyInputs.serialize());var container=this.closest('.cms-container');container.find('.cms-edit-form').tabs('select',0);container.loadPanel(url);return false;},onreset:function(e){this.clearForm();this.submit();}});$('.cms .cms-help-toggle').entwine({onmatch:function(){this._super();$(this.attr('href')).hide();},onunmatch:function(){this._super();},onclick:function(e){$(this.attr('href')).toggle();e.preventDefault();}});window._panelDeferredCache={};$('.cms-panel-deferred').entwine({onadd:function(){this._super();this.redraw();},onremove:function(){if(window.debug)console.log('saving',this.data('url'),this);if(!this.data('deferredNoCache'))window._panelDeferredCache[this.data('url')]=this.html();this._super();},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));var self=this,url=this.data('url');if(!url)throw'Elements of class .cms-panel-deferred need a "data-url" attribute';this._super();if(!this.children().length){if(!this.data('deferredNoCache')&&typeof window._panelDeferredCache[url]!=='undefined'){this.html(window._panelDeferredCache[url]);}else{this.addClass('loading');$.ajax({url:url,complete:function(){self.removeClass('loading');},success:function(data,status,xhr){self.html(data);}});}}}});$('.cms-tabset').entwine({onadd:function(){this.redrawTabs();this._super();},onremove:function(){this.tabs('destroy');this._super();},redrawTabs:function(){this.rewriteHashlinks();var id=this.attr('id'),cookieId='ui-tabs-'+id,selectedTab=this.find('ul:first .ui-tabs-selected');if($.cookie&&id&&$.cookie(cookieId)==-1)$.cookie(cookieId,0);if(!this.data('tabs'))this.tabs({cookie:($.cookie&&id)?{expires:30,path:'/',name:cookieId}:false,ajaxOptions:{beforeSend:function(xhr,settings){if(!isSameUrl(document.location.href,settings.url)){$('.cms-container').loadPanel(settings.url);}
return false;}},selected:(selectedTab.index()!=-1)?selectedTab.index():0});},rewriteHashlinks:function(){$(this).find('ul a').each(function(){var href=$(this).attr('href').replace(/.*(#.*)/,'$1');if(href)$(this).attr('href',href);});}});});}(jQuery));var statusMessage=function(text,type){jQuery.noticeAdd({text:text,type:type});};var errorMessage=function(text){jQuery.noticeAdd({text:text,type:'error'});};
;
/****** FILE: framework/admin/javascript/LeftAndMain.Panel.js *****/

(function($){$.entwine('ss',function($){$.entwine.warningLevel=$.entwine.WARN_LEVEL_BESTPRACTISE;$('.cms-panel').entwine({WidthExpanded:null,WidthCollapsed:null,onmatch:function(){if(!this.find('.cms-panel-content').length)throw new Exception('Content panel for ".cms-panel" not found');if(!this.find('.cms-panel-toggle').length){var container=$("<div class='cms-panel-toggle south'></div>").append('<a class="toggle-expand" href="#"><span>&raquo;</span></a>').append('<a class="toggle-collapse" href="#"><span>&laquo;</span></a>');this.append(container);}
this.setWidthExpanded(this.find('.cms-panel-content').innerWidth());var collapsedContent=this.find('.cms-panel-content-collapsed');this.setWidthCollapsed(collapsedContent.length?collapsedContent.innerWidth():this.find('.toggle-expand').innerWidth());var collapsed,cookieCollapsed;if($.cookie&&this.attr('id')){cookieCollapsed=$.cookie('cms-panel-collapsed-'+this.attr('id'));if(typeof cookieCollapsed!='undefined'&&cookieCollapsed!=null)collapsed=(cookieCollapsed=='true');}
if(typeof collapsed=='undefined')collapsed=jQuery(this).hasClass('collapsed');this.togglePanel(!collapsed,true);this._super();},onunmatch:function(){this._super();},togglePanel:function(bool,silent){if(!silent){this.trigger('beforetoggle.sspanel',bool);this.trigger(bool?'beforeexpand':'beforecollapse');}
this.toggleClass('collapsed',!bool);var newWidth=bool?this.getWidthExpanded():this.getWidthCollapsed();this.width(newWidth);this.find('.toggle-collapse')[bool?'show':'hide']();this.find('.toggle-expand')[bool?'hide':'show']();var collapsedContent=this.find('.cms-panel-content-collapsed');if(collapsedContent.length){this.find('.cms-panel-content')[bool?'show':'hide']();this.find('.cms-panel-content-collapsed')[bool?'hide':'show']();}
if($.cookie&&this.attr('id'))$.cookie('cms-panel-collapsed-'+this.attr('id'),!bool,{path:'/',expires:31});this.trigger('toggle',bool);this.trigger(bool?'expand':'collapse');},expandPanel:function(force){if(!force&&!this.hasClass('collapsed'))return;this.togglePanel(true);},collapsePanel:function(force){if(!force&&this.hasClass('collapsed'))return;this.togglePanel(false);}});$('.cms-panel.collapsed').entwine({onclick:function(e){this.expandPanel();e.preventDefault();}});$('.cms-panel *').entwine({getPanel:function(){return this.parents('.cms-panel:first');}});$('.cms-panel .toggle-expand').entwine({onclick:function(e){e.preventDefault();this.getPanel().expandPanel();}});$('.cms-panel .toggle-collapse').entwine({onclick:function(e){this.getPanel().collapsePanel();return false;}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.Tree.js *****/

(function($){$.entwine('ss.tree',function($){$('.cms-tree').entwine({Hints:null,IsUpdatingTree:false,IsLoaded:false,onadd:function(){this._super();if($.isNumeric(this.data('jstree_instance_id')))return;var hints=this.attr('data-hints');if(hints)this.setHints($.parseJSON(hints));var self=this;this.jstree(this.getTreeConfig()).bind('loaded.jstree',function(e,data){self.setIsLoaded(true);self.updateFromEditForm();self.css('visibility','visible');data.inst._set_settings({'html_data':{'ajax':{'url':self.data('urlTree'),'data':function(node){var params=self.data('searchparams')||[];params=$.grep(params,function(n,i){return(n.name!='ID'&&n.name!='value');});params.push({name:'ID',value:$(node).data("id")?$(node).data("id"):0});params.push({name:'ajax',value:1});return params;}}}});data.inst.hide_checkboxes();}).bind('before.jstree',function(e,data){if(data.func=='start_drag'){if(!self.hasClass('draggable')||self.hasClass('multiselect')){e.stopImmediatePropagation();return false;}}
if($.inArray(data.func,['check_node','uncheck_node'])){var node=$(data.args[0]).parents('li:first');if(node.hasClass('disabled')){e.stopImmediatePropagation();return false;}}}).bind('move_node.jstree',function(e,data){if(self.getIsUpdatingTree())return;var movedNode=data.rslt.o,newParentNode=data.rslt.np,oldParentNode=data.inst._get_parent(movedNode),newParentID=$(newParentNode).data('id')||0,nodeID=$(movedNode).data('id');var siblingIDs=$.map($(movedNode).siblings().andSelf(),function(el){return $(el).data('id');});$.ajax({'url':self.data('urlSavetreenode'),'data':{ID:nodeID,ParentID:newParentID,SiblingIDs:siblingIDs},success:function(){$('.cms-edit-form :input[name=ParentID]').val(newParentID);self.updateNodesFromServer([nodeID]);},statusCode:{403:function(){$.jstree.rollback(data.rlbk);}}});}).bind('select_node.jstree check_node.jstree uncheck_node.jstree',function(e,data){$(document).triggerHandler(e,data);});},onremove:function(){this.jstree('destroy');this._super();},'from .cms-container':{onafterstatechange:function(e){this.updateFromEditForm();}},'from .cms-container form':{onaftersubmitform:function(e){var id=$('.cms-edit-form :input[name=ID]').val();this.updateNodesFromServer([id]);}},getTreeConfig:function(){var self=this;return{'core':{'initially_open':['record-0'],'animation':0,'html_titles':true},'html_data':{},'ui':{"select_limit":1,'initially_select':[this.find('.current').attr('id')]},"crrm":{'move':{'check_move':function(data){var movedNode=$(data.o),newParent=$(data.np),isMovedOntoContainer=data.ot.get_container()[0]==data.np[0],movedNodeClass=movedNode.getClassname(),newParentClass=newParent.getClassname(),hints=self.getHints(),disallowedChildren=[],hintKey=newParentClass?newParentClass:'Root',hint=(hints&&typeof hints[hintKey]!='undefined')?hints[hintKey]:null;if(hint&&movedNode.attr('class').match(/VirtualPage-([^\s]*)/))movedNodeClass=RegExp.$1;if(hint)disallowedChildren=(typeof hint.disallowedChildren!='undefined')?hint.disallowedChildren:[];var isAllowed=(movedNode.data('id')!==0&&(!isMovedOntoContainer||data.p=='inside')&&!newParent.hasClass('nochildren')&&(!disallowedChildren.length||$.inArray(movedNodeClass,disallowedChildren)==-1));return isAllowed;}}},'dnd':{"drop_target":false,"drag_target":false},'checkbox':{'two_state':true},'themes':{'theme':'apple','url':$('body').data('frameworkpath')+'/thirdparty/jstree/themes/apple/style.css'},'plugins':['html_data','ui','dnd','crrm','themes','checkbox']};},search:function(params,callback){if(params)this.data('searchparams',params);else this.removeData('searchparams');this.jstree('refresh',-1,callback);},getNodeByID:function(id){return this.find('*[data-id='+id+']');},createNode:function(html,data,callback){var self=this,parentNode=data.ParentID?self.find('li[data-id='+data.ParentID+']'):false,newNode=$(html);this.jstree('create_node',parentNode.length?parentNode:-1,'last','',function(node){var origClasses=node.attr('class');for(var i=0;i<newNode[0].attributes.length;i++){var attr=newNode[0].attributes[i];node.attr(attr.name,attr.value);}
node.addClass(origClasses).html(newNode.html());callback(node);});},updateNode:function(node,html,data){var self=this,newNode=$(html),origClasses=node.attr('class');var nextNode=data.NextID?this.find('li[data-id='+data.NextID+']'):false;var prevNode=data.PrevID?this.find('li[data-id='+data.PrevID+']'):false;var parentNode=data.ParentID?this.find('li[data-id='+data.ParentID+']'):false;for(var i=0;i<newNode[0].attributes.length;i++){var attr=newNode[0].attributes[i];node.attr(attr.name,attr.value);}
var origChildren=node.children('ul').detach();node.addClass(origClasses).html(newNode.html()).append(origChildren);if(nextNode&&nextNode.length){this.jstree('move_node',node,nextNode,'before');}
else if(prevNode&&prevNode.length){this.jstree('move_node',node,prevNode,'after');}
else{this.jstree('move_node',node,parentNode.length?parentNode:-1);}},updateFromEditForm:function(){var node,id=$('.cms-edit-form :input[name=ID]').val();if(id){node=this.getNodeByID(id);if(node.length){this.jstree('deselect_all');this.jstree('select_node',node);}else{this.updateNodesFromServer([id]);}}else{this.jstree('deselect_all');}},updateNodesFromServer:function(ids){if(this.getIsUpdatingTree()||!this.getIsLoaded())return;var self=this,includesNewNode=false;this.setIsUpdatingTree(true);self.jstree('open_node',this.getNodeByID(0));self.jstree('save_opened');self.jstree('save_selected');$.ajax({url:$.path.addSearchParams(this.data('urlUpdatetreenodes'),'ids='+ids.join(',')),dataType:'json',success:function(data,xhr){$.each(data,function(nodeId,nodeData){var node=self.getNodeByID(nodeId);if(!nodeData){self.jstree('delete_node',node);return;}
var correctStateFn=function(node){self.jstree('deselect_all');self.jstree('select_node',node);var hasChildren=(node.children('ul').length>0);node.toggleClass('jstree-leaf',!hasChildren);if(!hasChildren)node.removeClass('jstree-closed jstree-open');};if(node.length){self.updateNode(node,nodeData.html,nodeData);setTimeout(function(){correctStateFn(node);},500);}else{includesNewNode=true;self.createNode(nodeData.html,nodeData,function(newNode){correctStateFn(newNode);});}});if(!includesNewNode){self.jstree('deselect_all');self.jstree('reselect');self.jstree('reopen');}},complete:function(){self.setIsUpdatingTree(false);}});}});$('.cms-tree.multiple').entwine({onmatch:function(){this._super();this.jstree('show_checkboxes');},onunmatch:function(){this._super();this.jstree('uncheck_all');this.jstree('hide_checkboxes');},getSelectedIDs:function(){return $.map($(this).jstree('get_checked'),function(el,i){return $(el).data('id');});}});$('.cms-tree li').entwine({setEnabled:function(bool){this.toggleClass('disabled',!(bool));},getClassname:function(){var matches=this.attr('class').match(/class-([^\s]*)/i);return matches?matches[1]:'';},getID:function(){return this.data('id');}});$('.cms-tree-view-modes input.view-mode').entwine({onmatch:function(){this.redraw();this._super();},onunmatch:function(){this._super();},onclick:function(e){this.redraw();},redraw:function(type){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));$('.cms-tree').toggleClass('draggable',this.val()=='draggable').toggleClass('multiple',this.val()=='multiselect');}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.Ping.js *****/

(function($){$.entwine('ss.ping',function($){$('.cms-container').entwine({PingIntervalSeconds:5*60,onadd:function(){this._setupPinging();this._super();},_setupPinging:function(){var onSessionLost=function(xmlhttp,status){if(xmlhttp.status>400||xmlhttp.responseText==0){if(window.open('Security/login')){alert('Please log in and then try again');}else{alert('Please enable pop-ups for this site');}}};setInterval(function(){$.ajax({url:'admin/security/ping',global:false,complete:onSessionLost});},this.getPingIntervalSeconds()*1000);}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.Content.js *****/

(function($){$.entwine('ss',function($){$('.cms-content').entwine({onadd:function(){var self=this;this.find('.cms-tabset').redrawTabs();this.find('.ss-ui-tabs-nav').redraw();this._super();},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.layout();this.add(this.find('.cms-tabset')).redrawTabs();this.find('.cms-content-header').redraw();this.find('.cms-content-actions').redraw();this.layout();}});$('.cms-content .cms-tree').entwine({onadd:function(){var self=this;this._super();this.bind('select_node.jstree',function(e,data){var node=data.rslt.obj,loadedNodeID=self.find(':input[name=ID]').val(),origEvent=data.args[2],container=$('.cms-container');if(!origEvent){return false;}else if($(origEvent.target).hasClass('jstree-icon')||$(origEvent.target).hasClass('jstree-pageicon')){return false;}
if($(node).hasClass('disabled'))return false;if($(node).data('id')==loadedNodeID)return;var url=$(node).find('a:first').attr('href');if(url&&url!='#'){self.jstree('deselect_all');self.jstree('uncheck_all');if($.path.isExternal($(node).find('a:first')))url=url=$.path.makeUrlAbsolute(url,$('base').attr('href'));if(document.location.search)url=$.path.addSearchParams(url,document.location.search.replace(/^\?/,''));container.loadPanel(url);}else{self.removeForm();}});}});$('.cms-content .cms-content-fields').entwine({redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.layout();}});$('.cms-content .cms-content-header, .cms-content .cms-content-actions').entwine({redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.height('auto');this.height(this.innerHeight()-this.css('padding-top')-this.css('padding-bottom'));}});});})(jQuery);
;
/****** FILE: framework/admin/javascript/LeftAndMain.EditForm.js *****/

(function($){window.onbeforeunload=function(e){var form=$('.cms-edit-form');form.trigger('beforesubmitform');if(form.is('.changed'))return ss.i18n._t('LeftAndMain.CONFIRMUNSAVEDSHORT');};$.entwine('ss',function($){$('.cms-edit-form').entwine({PlaceholderHtml:'',ChangeTrackerOptions:{ignoreFieldSelector:'.no-change-track, .ss-upload :input'},onadd:function(){var self=this;this.attr("autocomplete","off");this._setupChangeTracker();for(var overrideAttr in{'action':true,'method':true,'enctype':true,'name':true}){var el=this.find(':input[name='+'_form_'+overrideAttr+']');if(el){this.attr(overrideAttr,el.val());el.remove();}}
if(this.hasClass('validationerror')){statusMessage(ss.i18n._t('ModelAdmin.VALIDATIONERROR','Validation Error'),'bad');var firstTabWithErrors=this.find('.message.validation:first').closest('.tab');$('.cms-container').clearCurrentTabState();firstTabWithErrors.closest('.tabset').tabs('select',firstTabWithErrors.attr('id'));}
var previewEl=$('.cms-preview');if(previewEl.length){previewEl.find('.cms-preview-controls').html(this.find('.cms-navigator').detach());}
this._super();},onremove:function(){this.changetracker('destroy');this._super();},onmatch:function(){this._super();this.find(':input:not(:submit)[data-skip-autofocus!="true"]').filter(':visible:first').focus();},onunmatch:function(){this._super();},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.add(this.find('.cms-tabset')).redrawTabs();this.find('.cms-content-header').redraw();this.layout();},_setupChangeTracker:function(){this.changetracker(this.getChangeTrackerOptions());},confirmUnsavedChanges:function(){this.trigger('beforesubmitform');return(this.is('.changed'))?confirm(ss.i18n._t('LeftAndMain.CONFIRMUNSAVED')):true;},onsubmit:function(e,button){if(button)this.closest('.cms-container').submitForm(this,button);return false;},validate:function(){var isValid=true;this.trigger('validate',{isValid:isValid});return isValid;}});$('.cms-edit-form .Actions input.action[type=submit], .cms-edit-form .Actions button.action').entwine({onclick:function(e){this.parents('form').trigger('submit',[this]);e.preventDefault();return false;}});$('.cms-edit-form .ss-tabset').entwine({onmatch:function(){var tabs=this.find("> ul:first");if(tabs.children("li").length==1){tabs.hide().parent().addClass("ss-tabset-tabshidden");}
this._super();},onunmatch:function(){this._super();}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.Menu.js *****/

(function($){$.entwine('ss',function($){$('.cms-panel.cms-menu').entwine({togglePanel:function(bool){$('.cms-menu-list').children('li').each(function(){if(bool){$(this).children('ul').each(function(){$(this).removeClass('collapsed-flyout');if($(this).data('collapse')){$(this).removeData('collapse');$(this).addClass('collapse');}});}else{$(this).children('ul').each(function(){$(this).addClass('collapsed-flyout');$(this).hasClass('collapse');$(this).removeClass('collapse');$(this).data('collapse',true);});}});this.toggleFlyoutState(bool);this._super(bool);},toggleFlyoutState:function(bool){if(bool){$('.collapsed').find('li').show();$('.cms-menu-list').find('.child-flyout-indicator').hide();}else{$('.collapsed-flyout').find('li').each(function(){$(this).hide();});var par=$('.cms-menu-list ul.collapsed-flyout').parent();if(par.children('.child-flyout-indicator').length===0)par.append('<span class="child-flyout-indicator"></span>').fadeIn();par.children('.child-flyout-indicator').fadeIn();}}});$('.cms-menu-list').entwine({onmatch:function(){var self=this;this.find('li.current').select();this.updateItems();this._super();},onunmatch:function(){this._super();},updateMenuFromResponse:function(xhr){var controller=xhr.getResponseHeader('X-Controller');if(controller){var item=this.find('li#Menu-'+controller);if(!item.hasClass('current'))item.select();}
this.updateItems();},'from .cms-container':{onafterstatechange:function(e,data){this.updateMenuFromResponse(data.xhr);},onaftersubmitform:function(e,data){this.updateMenuFromResponse(data.xhr);}},'from .cms-edit-form':{onrelodeditform:function(e,data){this.updateMenuFromResponse(data.xmlhttp);}},getContainingPanel:function(){return this.closest('.cms-panel');},fromContainingPanel:{ontoggle:function(e){this.toggleClass('collapsed',$(e.target).hasClass('collapsed'));}},updateItems:function(){var editPageItem=this.find('#Menu-CMSMain');editPageItem[editPageItem.is('.current')?'show':'hide']();var currentID=$('.cms-content input[name=ID]').val();if(currentID){this.find('li').each(function(){if($.isFunction($(this).setRecordID))$(this).setRecordID(currentID);});}}});$('.cms-menu-list li').entwine({toggleFlyout:function(bool){fly=$(this);if(fly.children('ul').first().hasClass('collapsed-flyout')){if(bool){fly.children('ul').find('li').fadeIn('fast');}else{fly.children('ul').find('li').hide();}}}});$('.cms-menu-list li').hoverIntent(function(){$(this).toggleFlyout(true);},function(){$(this).toggleFlyout(false);});$('.cms-menu-list .toggle').entwine({onclick:function(e){this.getMenuItem().toggle();e.preventDefault();}});$('.cms-menu-list li').entwine({onmatch:function(){if(this.find('ul').length){this.find('a:first').append('<span class="toggle-children"><span class="toggle-children-icon"></span></span>');}
this._super();},onunmatch:function(){this._super();},toggle:function(){this[this.hasClass('opened')?'close':'open']();},open:function(){var parent=this.getMenuItem();if(parent)parent.open();this.addClass('opened').find('ul').show();this.find('.toggle-children').addClass('opened');},close:function(){this.removeClass('opened').find('ul').hide();this.find('.toggle-children').removeClass('opened');},select:function(){var parent=this.getMenuItem();this.addClass('current').open();this.siblings().removeClass('current').close();this.siblings().find('li').removeClass('current');if(parent){var parentSiblings=parent.siblings();parent.addClass('current');parentSiblings.removeClass('current').close();parentSiblings.find('li').removeClass('current').close();}
this.getMenu().updateItems();this.trigger('select');}});$('.cms-menu-list *').entwine({getMenu:function(){return this.parents('.cms-menu-list:first');}});$('.cms-menu-list li *').entwine({getMenuItem:function(){return this.parents('li:first');}});$('.cms-menu-list li a').entwine({onclick:function(e){var isExternal=$.path.isExternal(this.attr('href'));if(e.which>1||isExternal)return;e.preventDefault();var item=this.getMenuItem();var url=this.attr('href');if(!isExternal)url=$('base').attr('href')+url;var children=item.find('li');if(children.length){children.first().find('a').click();}else{if(!$('.cms-container').loadPanel(url))return false;}
item.select();}});$('.cms-menu-list li .toggle-children').entwine({onclick:function(e){var li=this.closest('li');li.toggle();return false;}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.AddForm.js *****/

(function($){$.entwine('ss',function($){$('.cms-edit-form.cms-add-form').entwine({OrigOptions:null,NewPages:[],getTree:function(){return $('.cms-tree');},fromTree:{onselect_node:function(e,data){this.refresh(data.rslt.obj);}},onadd:function(){var self=this,typeDropdown=this.find(':input[name=PageType]');typeDropdown.bind('change',function(e){self.refresh();});var opts={};typeDropdown.find('option').each(function(el){opts[$(this).val()]={html:$(this).html(),value:$(this).val()};});this.setOrigOptions(opts);this._super();},onsubmit:function(e){var newPages=this.getNewPages(),tree=this.getTree(),node=$(tree).jstree('get_selected');var parentID=(node.length)?node.data('id'):0;if(node&&node.hasClass("nochildren")){alert(ss.i18n._t('CMSMAIN.CANTADDCHILDREN'));}
if(!newPages[parentID])newPages[parentID]=1;var button=this.find(':submit:first');button.addClass('loading');var data=this.serializeArray();data.push({name:'Suffix',value:newPages[parentID]++});data.push({name:button.attr('name'),value:button.val()});$('.cms-container').submitForm(this,button,function(){button.removeClass('loading');},{type:'POST',data:data,headers:{'X-Pjax':'Content'}});this.setNewPages(newPages);return false;},refresh:function(selectedNode){var tree=this.getTree(),selectedNode=selectedNode||$(tree).jstree('get_selected')
origOptions=this.getOrigOptions(),dropdown=this.find('select[name=PageType]'),disallowed=[],className=(selectedNode.length>0)?selectedNode.entwine('ss.tree').getClassname():null,siteTreeHints=$.parseJSON($('#sitetree_ul').attr('data-hints')),disableDropDown=true,selectedOption=dropdown.val();dropdown.find('option').remove();if(className&&siteTreeHints){disallowed=siteTreeHints[className].disallowedChildren;}
$.each(origOptions,function(i,optProps){if($.inArray(i,disallowed)===-1&&optProps){dropdown.append($('<option value="'+optProps.value+'">'+optProps.html+'</option>'));disableDropDown=false;}});if(!disableDropDown)dropdown.removeAttr('disabled');else dropdown.attr('disabled','disabled');if(selectedOption)dropdown.val(selectedOption);if(selectedNode.hints&&selectedNode.hints.defaultChild){dropdown.val(selectedNode.hints.defaultChild);}
this.find(':input[name=ParentID]').val(selectedNode?selectedNode.data('id'):0);}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.Preview.js *****/

(function($){$.entwine('ss',function($){$('.cms-preview').entwine({SharedWidth:null,onadd:function(){var self=this,layoutContainer=this.parent();this.setSharedWidth(500);this.find('iframe').addClass('center');this.find('iframe').bind('load',function(){self._fixIframeLinks();if(!self.is('.is-collapsed'))self.loadCurrentPage();});if(this.hasClass('is-expanded'))this.expand();else this.collapse();this.data('cms-preview-initialized',true);this.append('<div class="cms-preview-overlay ui-widget-overlay-light"></div>');this.find('.cms-preview-overlay-light').hide();$('.cms-preview-toggle-link')[this.canPreview()?'show':'hide']();self._fixIframeLinks();this._super();},loadUrl:function(url){this.find('iframe').attr('src',url);},updateAfterXhr:function(){$('.cms-preview-toggle-link')[this.canPreview()?'show':'hide']();if(this.is('.is-collapsed'))return;var url=$('.cms-edit-form').choosePreviewLink();if(url){this.loadUrl(url);this.unblock();}else{this.block();}},'from .cms-container':{onaftersubmitform:function(){this.updateAfterXhr();},onafterstatechange:function(){this.updateAfterXhr();}},'from .cms-menu-list li':{onselect:function(){if(!this.hasClass('is-collapsed'))this.collapse();}},loadCurrentPage:function(){var doc=this.find('iframe')[0].contentDocument,containerEl=this.getLayoutContainer();if(!this.canPreview())return;var id=$(doc).find('meta[name=x-page-id]').attr('content');var editLink=$(doc).find('meta[name=x-cms-edit-link]').attr('content');var contentPanel=$('.cms-content');if(id&&contentPanel.find(':input[name=ID]').val()!=id){if(window.History.enabled)
$('.cms-container').loadPanel(editLink);}},canPreview:function(){var contentEl=this.getLayoutContainer().find('.cms-content');var blockedClasses=['CMSPagesController','CMSSettingsController','CMSPageHistoryController'];return!(contentEl.is('.'+blockedClasses.join(',.')));},_fixIframeLinks:function(){var doc=this.find('iframe')[0].contentDocument;if(!doc)return;var links=doc.getElementsByTagName('A');for(var i=0;i<links.length;i++){var href=links[i].getAttribute('href');if(!href)continue;if(href.match(/^http:\/\//))links[i].setAttribute('target','_blank');}
var navi=doc.getElementById('SilverStripeNavigator');if(navi)navi.style.display='none';var naviMsg=doc.getElementById('SilverStripeNavigatorMessage');if(naviMsg)naviMsg.style.display='none';},expand:function(inclMenu){var self=this,containerEl=this.getLayoutContainer(),contentEl=containerEl.find('.cms-content');this.show();this.removeClass('east').addClass('center').removeClass('is-collapsed');contentEl.removeClass('center').hide();this.find('iframe').show();this.find('.cms-preview-toggle a').html('&raquo;');this.find('.cms-preview-controls').show();if(this.data('cms-preview-initialized')){containerEl.find('.cms-menu').collapsePanel();}
containerEl.redraw();},collapse:function(){var self=this,containerEl=this.getLayoutContainer(),contentEl=containerEl.find('.cms-content');this.addClass('east').removeClass('center').addClass('is-collapsed').width(10);contentEl.addClass('center').show().css('visibility','visible');this.find('iframe').hide();this.find('.cms-preview-toggle a').html('&laquo;');this.find('.cms-preview-controls').hide();if(this.data('cms-preview-initialized')){containerEl.find('.cms-menu').expandPanel();}
containerEl.redraw();},block:function(){this.addClass('blocked');},unblock:function(){this.removeClass('blocked');},getLayoutContainer:function(){return this.parents('.cms-container');},toggle:function(bool){this[this.hasClass('is-collapsed')?'expand':'collapse']();},redraw:function(){if(window.debug)console.log('redraw',this.attr('class'),this.get(0));this.layout({resize:false});}});$('.cms-preview.collapsed').entwine({onmatch:function(){this.find('a').text('<');this._super();},onunmatch:function(){this._super();}});$('.cms-preview.blocked').entwine({onmatch:function(){this.find('.cms-preview-overlay').show();this._super();},onunmatch:function(){this.find('.cms-preview-overlay').hide();this._super();}});$('.cms-preview.expanded').entwine({onmatch:function(){this.find('a').text('>');this._super();},onunmatch:function(){this._super();}});$('.cms-preview .cms-preview-toggle').entwine({onclick:function(e){e.preventDefault();this.parents('.cms-preview').toggle();}});$('.cms-switch-view a').entwine({onclick:function(e){e.preventDefault();var preview=$('.cms-preview');preview.toggle(true);preview.loadUrl($(e.target).attr('href'));}});$('.cms-menu li').entwine({onclick:function(e){if(this.hasClass('Menu-CMSMain')){var preview=$('.cms-preview');preview.toggle(true);e.preventDefault();}}});$('.cms-preview .cms-preview-states').entwine({onmatch:function(){this.find('a').addClass('disabled');this.find('.active a').removeClass('disabled');this.find('.cms-preview-watermark').show();this.find('.active .cms-preview-watermark').hide();this._super();},onunmatch:function(){this._super();}});$('.cms-preview .cms-preview-states a').entwine({onclick:function(e){e.preventDefault();this.parents('.cms-preview').loadUrl(this.attr('href'));this.addClass('disabled');this.parents('.cms-preview-states').find('a').not(this).removeClass('disabled');this.parents('.cms-preview-states').find('.cms-preview-watermark').hide();this.siblings('.cms-preview-watermark').show();}});$('.cms-preview-toggle-link').entwine({onclick:function(e){e.preventDefault();var preview=$('.cms-preview'),url=$('.cms-edit-form').choosePreviewLink();if(url){preview.loadUrl(url);preview.unblock();preview.toggle();}}});$('.cms-edit-form').entwine({choosePreviewLink:function(){var self=this,urls=$.map(['PreviewURL','StageLink','LiveLink'],function(name){var val=self.find(':input[name='+name+']').val();return val?val:null;});return urls?urls[0]:false;}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.BatchActions.js *****/

(function($){$.entwine('ss.tree',function($){$('#Form_BatchActionsForm').entwine({Actions:[],getTree:function(){return $('.cms-tree');},fromTree:{oncheck_node:function(e,data){this.serializeFromTree();},onuncheck_node:function(e,data){this.serializeFromTree();}},onadd:function(){this._updateStateFromViewMode();this._super();},'from .cms-tree-view-modes :input[name=view-mode]':{onclick:function(e){var val=$(e.target).val(),dropdown=this.find(':input[name=Action]'),tree=this.getTree();if(val=='multiselect'){tree.addClass('multiple');this.serializeFromTree();}else{tree.removeClass('multiple');}
this._updateStateFromViewMode();}},_updateStateFromViewMode:function(){var viewMode=$('.cms-tree-view-modes :input[name=view-mode]:checked').val();var dropdown=this.find(':input[name=Action]');if(viewMode=='multiselect')dropdown.removeAttr('disabled').trigger("liszt:updated");else dropdown.attr('disabled',true).trigger("liszt:updated");},register:function(type,callback){this.trigger('register',{type:type,callback:callback});var actions=this.getActions();actions[type]=callback;this.setActions(actions);},unregister:function(type){this.trigger('unregister',{type:type});var actions=this.getActions();if(actions[type])delete actions[type];this.setActions(actions);},_isActive:function(){return $('.cms-content-batchactions').is(':visible');},refreshSelected:function(rootNode){var self=this,st=this.getTree(),ids=this.getIDs(),allIds=[];if(rootNode==null)rootNode=st;for(var idx in ids){$($(st).getNodeByID(idx)).addClass('selected').attr('selected','selected');}
$(rootNode).find('li').each(function(){allIds.push($(this).data('id'));$(this).addClass('treeloading').setEnabled(false);});var applicablePagesURL=this.find(':input[name=Action]').val()+'/applicablepages/?csvIDs='+allIds.join(',');jQuery.getJSON(applicablePagesURL,function(applicableIDs){jQuery(rootNode).find('li').each(function(){$(this).removeClass('treeloading');var id=$(this).data('id');if(id==0||$.inArray(id,applicableIDs)>=0){$(this).setEnabled(true);}else{$(this).removeClass('selected').setEnabled(false);}});self.serializeFromTree();});},serializeFromTree:function(){var tree=this.getTree(),ids=tree.getSelectedIDs();if(!ids||!ids.length)return false;this.setIDs(ids);return true;},setIDs:function(ids){this.find(':input[name=csvIDs]').val(ids?ids.join(','):null);},getIDs:function(){return this.find(':input[name=csvIDs]').val().split(',');},onsubmit:function(e){var self=this,ids=this.getIDs(),tree=this.getTree();if(!ids||!ids.length){alert(ss.i18n._t('CMSMAIN.SELECTONEPAGE'));return false;}
var type=this.find(':input[name=Action]').val();if(this.getActions()[type])ids=this.getActions()[type].apply(this,[ids]);this.setIDs(ids);tree.find('li').removeClass('failed');var button=this.find(':submit:first');button.addClass('loading');jQuery.ajax({url:type,type:'POST',data:this.serializeArray(),complete:function(xmlhttp,status){button.removeClass('loading');tree.jstree('uncheck_all');self.setIDs([]);self.find(':input[name=Action]').val('').change();var msg=xmlhttp.getResponseHeader('X-Status');if(msg)statusMessage(decodeURIComponent(msg),(status=='success')?'good':'bad');},success:function(data,status){var id,node;if(data.modified){var modifiedNodes=[];for(id in data.modified){node=tree.getNodeByID(id);tree.jstree('set_text',node,data.modified[id]['TreeTitle']);modifiedNodes.push(node);}
$(modifiedNodes).effect('highlight');}
if(data.deleted){for(id in data.deleted){node=tree.getNodeByID(id);if(node.length)tree.jstree('delete_node',node);}}
if(data.error){for(id in data.error){node=tree.getNodeByID(id);$(node).addClass('failed');}}},dataType:'json'});return false;}});$('#Form_BatchActionsForm select[name=Action]').entwine({onmatch:function(){this.trigger('change');this._super();},onunmatch:function(){this._super();},onchange:function(e){var form=$(e.target.form),btn=form.find(':submit');if($(e.target).val()==-1){btn.attr('disabled','disabled').button('refresh');}else{btn.removeAttr('disabled').button('refresh');}
this.trigger("liszt:updated");this._super(e);}});$(document).ready(function(){$('#Form_BatchActionsForm').register('admin/batchactions/publish',function(ids){var confirmed=confirm("You have "+ids.length+" pages selected.\n\n"
+"Do your really want to publish?");return(confirmed)?ids:false;});$('#Form_BatchActionsForm').register('admin/batchactions/unpublish',function(ids){var confirmed=confirm("You have "+ids.length+" pages selected.\n\n"
+"Do your really want to unpublish?");return(confirmed)?ids:false;});$('#Form_BatchActionsForm').register('admin/batchactions/delete',function(ids){var confirmed=confirm("You have "+ids.length+" pages selected.\n\n"
+"Do your really want to delete?");return(confirmed)?ids:false;});$('#Form_BatchActionsForm').register('admin/batchactions/deletefromlive',function(ids){var confirmed=confirm("You have "+ids.length+" pages selected.\n\n"
+"Do your really want to delete these pages from live?");return(confirmed)?ids:false;});});});})(jQuery);
;
/****** FILE: framework/admin/javascript/LeftAndMain.FieldHelp.js *****/

(function($){$.entwine('ss',function($){$(".cms form .field .middleColumn > [title]").entwine({onmatch:function(){var title=this.prop("title");if(title&&title.length){var span=$("<span></span>",{"class":"help","text":title});this.closest(".field").append(span);this.removeProp("title");}
this._super();}});});}(jQuery));
;
/****** FILE: framework/admin/javascript/LeftAndMain.TreeDropdownField.js *****/

(function($){$.entwine('ss',function($){$('.TreeDropdownField').entwine({'from .cms-container form':{onaftersubmitform:function(e){this.find('.tree-holder').empty();this._super();}}});});})(jQuery);
;
/****** FILE: framework/javascript/lang/en_US.js *****/

if(typeof(ss)=='undefined'||typeof(ss.i18n)=='undefined'){if(typeof(console)!='undefined')console.error('Class ss.i18n not defined');}else{ss.i18n.addDictionary('en_US',{'VALIDATOR.FIELDREQUIRED':'Please fill out "%s", it is required.','HASMANYFILEFIELD.UPLOADING':'Uploading... %s','TABLEFIELD.DELETECONFIRMMESSAGE':'Are you sure you want to delete this record?','LOADING':'loading...','UNIQUEFIELD.SUGGESTED':"Changed value to '%s' : %s",'UNIQUEFIELD.ENTERNEWVALUE':'You will need to enter a new value for this field','UNIQUEFIELD.CANNOTLEAVEEMPTY':'This field cannot be left empty','RESTRICTEDTEXTFIELD.CHARCANTBEUSED':"The character '%s' cannot be used in this field",'UPDATEURL.CONFIRM':'Would you like me to change the URL to:\n\n%s/\n\nClick Ok to change the URL, click Cancel to leave it as:\n\n%s','UPDATEURL.CONFIRMURLCHANGED':'The URL has been changed to\n"%s"','FILEIFRAMEFIELD.DELETEFILE':'Delete File','FILEIFRAMEFIELD.UNATTACHFILE':'Un-Attach File','FILEIFRAMEFIELD.DELETEIMAGE':'Delete Image','FILEIFRAMEFIELD.CONFIRMDELETE':'Are you sure you want to delete this file?','LeftAndMain.IncompatBrowserWarning':'Your browser is not compatible with the CMS interface. Please use Internet Explorer 7+, Google Chrome 10+ or Mozilla Firefox 3.5+.','GRIDFIELD.ERRORINTRANSACTION':'An error occured while fetching data from the server\n Please try again later.','HtmlEditorField.SelectAnchor':'Select an anchor','UploadField.ConfirmDelete':'Are you sure you want to remove this file from the server filesystem?','UploadField.PHP_MAXFILESIZE':'File exceeds upload_max_filesize (php.ini directive)','UploadField.HTML_MAXFILESIZE':'File exceeds MAX_FILE_SIZE (HTML form directive)','UploadField.ONLYPARTIALUPLOADED':'File was only partially uploaded','UploadField.NOFILEUPLOADED':'No File was uploaded','UploadField.NOTMPFOLDER':'Missing a temporary folder','UploadField.WRITEFAILED':'Failed to write file to disk','UploadField.STOPEDBYEXTENSION':'File upload stopped by extension','UploadField.TOOLARGE':'Filesize is too large','UploadField.TOOSMALL':'Filesize is too small','UploadField.INVALIDEXTENSION':'Extension is not allowed','UploadField.MAXNUMBEROFFILESSIMPLE':'Max number of files exceeded','UploadField.UPLOADEDBYTES':'Uploaded bytes exceed file size','UploadField.EMPTYRESULT':'Empty file upload result','UploadField.LOADING':'Loading ...','UploadField.Editing':'Editing ...','UploadField.Uploaded':'Uploaded'});}
;
/****** FILE: framework/admin/javascript/lang/en_US.js *****/

if(typeof(ss)=='undefined'||typeof(ss.i18n)=='undefined'){if(typeof(console)!='undefined')console.error('Class ss.i18n not defined');}else{ss.i18n.addDictionary('en_US',{'LeftAndMain.CONFIRMUNSAVED':"Are you sure you want to navigate away from this page?\n\nWARNING: Your changes have not been saved.\n\nPress OK to continue, or Cancel to stay on the current page.",'LeftAndMain.CONFIRMUNSAVEDSHORT':"WARNING: Your changes have not been saved.",'SecurityAdmin.BATCHACTIONSDELETECONFIRM':"Do you really want to delete %s groups?",'ModelAdmin.SAVED':"Saved",'ModelAdmin.REALLYDELETE':"Do you really want to delete?",'ModelAdmin.DELETED':"Deleted",'ModelAdmin.VALIDATIONERROR':"Validation Error",'LeftAndMain.PAGEWASDELETED':"This page was deleted.  To edit a page, select it from the left."});}
;
